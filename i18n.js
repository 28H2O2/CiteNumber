const i18n = {
    zh: {
        title: "üìö ËÆ∫ÊñáÂºïÁî®Êü•ËØ¢Âô®",
        subtitle: "Âø´ÈÄüÊü•ËØ¢Â≠¶ÊúØËÆ∫ÊñáÁöÑÂºïÁî®Ê¨°Êï∞",
        singleTab: "Âçï‰∏™Êü•ËØ¢",
        batchTab: "ÊâπÈáèÊü•ËØ¢",
        searchPlaceholder: "ËØ∑ËæìÂÖ•ËÆ∫ÊñáÊ†áÈ¢òÊàñÂÖ≥ÈîÆËØç...",
        batchPlaceholder: "ËØ∑ËæìÂÖ•Â§ö‰∏™ËÆ∫ÊñáÊ†áÈ¢òÔºåÊØèË°å‰∏Ä‰∏™...\n\n‰æãÂ¶ÇÔºö\nAttention Is All You Need\nBERT: Pre-training of Deep Bidirectional Transformers\nGPT-3: Language Models are Few-Shot Learners",
        searchButton: "ÊêúÁ¥¢",
        batchSearchButton: "ÊâπÈáèÊü•ËØ¢",
        paperCount: "ÁØáËÆ∫Êñá",
        tips: "üí° ÊèêÁ§∫ÔºöËæìÂÖ•ÂÆåÊï¥ÁöÑËÆ∫ÊñáÊ†áÈ¢òÂèØËé∑ÂæóÊõ¥ÂáÜÁ°ÆÁöÑÁªìÊûú | ÊîØÊåÅÊâπÈáèÊü•ËØ¢Â§öÁØáËÆ∫Êñá",
        searchHistory: "üìù ÊêúÁ¥¢ÂéÜÂè≤",
        clearHistory: "Ê∏ÖÈô§ÂéÜÂè≤",
        emptyHistory: "ÊöÇÊó†ÊêúÁ¥¢ÂéÜÂè≤",
        searching: "Ê≠£Âú®ÊêúÁ¥¢‰∏≠...",
        batchSearching: "Ê≠£Âú®ÊâπÈáèÊü•ËØ¢",
        searchResults: "ÊêúÁ¥¢ÁªìÊûú",
        batchResults: "ÊâπÈáèÊü•ËØ¢ÁªìÊûú",
        noResults: "üòî Êú™ÊâæÂà∞Áõ∏ÂÖ≥ËÆ∫Êñá",
        noResultsHint: "ËØ∑Â∞ùËØï‰ΩøÁî®Êõ¥ÂáÜÁ°ÆÁöÑËÆ∫ÊñáÊ†áÈ¢òÊàñ‰∏çÂêåÁöÑÂÖ≥ÈîÆËØç",
        searchError: "ÊêúÁ¥¢Âá∫ÈîôÔºåËØ∑Á®çÂêéÈáçËØï",
        citations: "Ë¢´ÂºïÁî®",
        times: "Ê¨°",
        viewDetails: "Êü•ÁúãËØ¶ÊÉÖ",
        authors: "‰ΩúËÄÖÊú™Áü•",
        yearUnknown: "Âπ¥‰ªΩÊú™Áü•",
        justNow: "ÂàöÂàö",
        minutesAgo: "ÂàÜÈíüÂâç",
        hoursAgo: "Â∞èÊó∂Ââç",
        daysAgo: "Â§©Ââç",
        footer: "Êï∞ÊçÆÊù•Ê∫êÔºöSemantic Scholar | ‰ªÖ‰æõÂ≠¶ÊúØÂèÇËÄÉ‰ΩøÁî®",
        completed: "ÂÆåÊàê",
        notFound: "ÁØáËÆ∫ÊñáÊú™ÊâæÂà∞ÁªìÊûú",
        clearHistoryConfirm: "Á°ÆÂÆöË¶ÅÊ∏ÖÈô§ÊâÄÊúâÊêúÁ¥¢ÂéÜÂè≤ÂêóÔºü",
        enterTitle: "ËØ∑ËæìÂÖ•ËÆ∫ÊñáÊ†áÈ¢òÊàñÂÖ≥ÈîÆËØç",
        enterBatchTitle: "ËØ∑ËæìÂÖ•Ë¶ÅÊâπÈáèÊü•ËØ¢ÁöÑËÆ∫ÊñáÊ†áÈ¢ò",
        atLeastOne: "ËØ∑ËæìÂÖ•Ëá≥Â∞ë‰∏Ä‰∏™ËÆ∫ÊñáÊ†áÈ¢ò",
        maxTenPapers: "ÊâπÈáèÊü•ËØ¢ÊúÄÂ§öÊîØÊåÅ10ÁØáËÆ∫ÊñáÔºåËØ∑ÂáèÂ∞ëËæìÂÖ•",
        queryFailed: "Êü•ËØ¢Â§±Ë¥•",
        checkTitle: "ËØ∑Ê£ÄÊü•ËÆ∫ÊñáÊ†áÈ¢òÊòØÂê¶Ê≠£Á°Æ"
    },
    en: {
        title: "üìö Paper Citation Query",
        subtitle: "Quickly search academic paper citation counts",
        singleTab: "Single Search",
        batchTab: "Batch Search",
        searchPlaceholder: "Enter paper title or keywords...",
        batchPlaceholder: "Enter multiple paper titles, one per line...\n\nFor example:\nAttention Is All You Need\nBERT: Pre-training of Deep Bidirectional Transformers\nGPT-3: Language Models are Few-Shot Learners",
        searchButton: "Search",
        batchSearchButton: "Batch Search",
        paperCount: "papers",
        tips: "üí° Tip: Enter complete paper titles for more accurate results | Supports batch search for multiple papers",
        searchHistory: "üìù Search History",
        clearHistory: "Clear History",
        emptyHistory: "No search history",
        searching: "Searching...",
        batchSearching: "Batch searching",
        searchResults: "Search Results",
        batchResults: "Batch Search Results",
        noResults: "üòî No papers found",
        noResultsHint: "Try using more accurate paper titles or different keywords",
        searchError: "Search error, please try again later",
        citations: "Citations",
        times: "",
        viewDetails: "View Details",
        authors: "Authors unknown",
        yearUnknown: "Year unknown",
        justNow: "just now",
        minutesAgo: "minutes ago",
        hoursAgo: "hours ago",
        daysAgo: "days ago",
        footer: "Data source: Semantic Scholar | For academic reference only",
        completed: "completed",
        notFound: "papers not found",
        clearHistoryConfirm: "Are you sure you want to clear all search history?",
        enterTitle: "Please enter paper title or keywords",
        enterBatchTitle: "Please enter paper titles for batch search",
        atLeastOne: "Please enter at least one paper title",
        maxTenPapers: "Batch search supports up to 10 papers, please reduce input",
        queryFailed: "Query failed",
        checkTitle: "Please check if the paper title is correct"
    }
};

let currentLang = localStorage.getItem('language') || 'zh';

function t(key) {
    return i18n[currentLang][key] || key;
}

function setLanguage(lang) {
    currentLang = lang;
    localStorage.setItem('language', lang);
    document.documentElement.lang = lang === 'zh' ? 'zh-CN' : 'en';

    // Update language button states
    document.querySelectorAll('.lang-btn').forEach(btn => {
        if (btn.dataset.lang === lang) {
            btn.classList.add('active');
        } else {
            btn.classList.remove('active');
        }
    });

    updateUILanguage();
}

function updateUILanguage() {
    document.querySelector('header h1').textContent = t('title');
    document.querySelector('.subtitle').textContent = t('subtitle');
    document.querySelectorAll('.tab-btn')[0].textContent = t('singleTab');
    document.querySelectorAll('.tab-btn')[1].textContent = t('batchTab');
    document.getElementById('searchInput').placeholder = t('searchPlaceholder');
    document.getElementById('batchInput').placeholder = t('batchPlaceholder');
    document.querySelector('#searchBtn').innerHTML = `
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"/>
            <path d="m21 21-4.35-4.35"/>
        </svg>
        ${t('searchButton')}
    `;
    document.querySelector('.batch-search-btn').innerHTML = `
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 11H3m6 0V5m0 6l-3-3m3 3l3-3m6 1a4 4 0 11-8 0 4 4 0 018 0zm6 8H15m6 0v-6m0 6l-3 3m3-3l3 3"/>
        </svg>
        ${t('batchSearchButton')}
    `;
    document.querySelector('.tips p').textContent = t('tips');
    document.querySelector('.history-header h3').textContent = t('searchHistory');
    document.querySelector('.clear-history-btn').textContent = t('clearHistory');
    document.querySelector('footer p').textContent = t('footer');

    const resultsHeader = document.querySelector('#resultsSection h2');
    if (resultsHeader && resultsHeader.textContent) {
        if (resultsHeader.textContent.includes('ÊâπÈáèÊü•ËØ¢ÁªìÊûú') || resultsHeader.textContent.includes('Batch Search Results')) {
            resultsHeader.textContent = t('batchResults');
        } else {
            resultsHeader.textContent = t('searchResults');
        }
    }

    const batchCount = document.querySelector('.batch-count');
    if (batchCount) {
        const count = batchCount.textContent.match(/\d+/);
        if (count) {
            batchCount.textContent = `${count[0]} ${t('paperCount')}`;
        }
    }

    renderHistory();
}

document.addEventListener('DOMContentLoaded', function() {
    setLanguage(currentLang);
});